# ===========================================
# A. Doublons et casse
# ===========================================

server {
    root www;
    root ./www;                   # Doublon de root (même directive deux fois)
    INDEX index.html;             # Majuscules dans la directive
    index index2.html;            # Doublon (même directive deux fois, avec autre valeur)
}

# ===========================================
# B. Valeurs manquantes ou vides
# ===========================================

server {
    root;                         # Clé sans valeur
    index ;                       # Clé avec espace mais pas de valeur
    error_page 404 ;              # Code erreur sans fichier
    autoindex;                    # Sans valeur
}

# ===========================================
# C. Valeurs invalides
# ===========================================

server {
    listen abc:80;                # Host non IP
    listen 0.0.0.0:99999;         # Port hors limites
    client_max_body_size 99999999999999999999; # Overflow
    client_max_body_size 42Z;     # Unité inconnue
    autoindex yes;                # Valeur non attendue
    allow_methods GET FLY;        # Méthode non supportée
    cgi_path /usr/bin/nonexistent;# Chemin inexistant
}

# ===========================================
# D. Erreurs de structure
# ===========================================

root www;                         # Directive hors bloc server

server {
    server {                      # Bloc server dans un autre server
        root www;
    }
}

server {
    location /foo/ {              # Bloc location non fermé
        root www/foo;
#   } <-- manquant volontairement
}

server {
    location /bar/ {
        root www/bar;
        location /baz/ {          # Bloc location dans location (interdit)
            root www/bar/baz;
        }
    }
}

# ===========================================
# E. Héritage et surcharge
# ===========================================

server {
    root www;
    index index.html index.htm;

    location /img/ {
        # Pas de root → doit hériter
        index img.html;
    }

    location /download/ {
        root www/files;
        # Pas d'index → doit hériter du server
    }

    location /upload/ {
        client_max_body_size 1m;  # Limite spécifique à cette location
    }
}

# ===========================================
# F. Fichiers/dossiers manquants
# ===========================================

server {
    root dossier_inexistant;      # root inexistant
    index file_absent.html;       # index absent sur le disque
    error_page 404 absent404.html;# page erreur absente
    upload_dir non_existant;      # dossier upload inexistant
}

# ===========================================
# G. Blocs valides pour la suite des tests HTTP
# ===========================================

server {
    listen 127.0.0.1:8080;
    root www;
    index index.html;
    server_name test;
    client_max_body_size 1M;

    location / {
        autoindex on;
        allow_methods GET POST;
    }

    location /upload/ {
        root www/upload;
        upload_dir www/upload;
        allow_methods POST;
        client_max_body_size 10K;
    }

    location /delete/ {
        root www/delete;
        allow_methods DELETE;
    }
}
